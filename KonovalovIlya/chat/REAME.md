# 5. P2P чат

## Сборка и запуск
Для успешного запуска должна быть установлена переменная окружения JAVA_HOME, указывающая на JDK 17+.

### Сборка
```shell
./mvnw clean package
```
### Запуск
Для запуска каждого из пиров необходимо выполнить команду
```shell
java -jar target/p2p-chat-jar-with-dependencies.jar
```

## Описание решения
Решение выполнено в виде консольной утилиты.

При запуске предлагается ввести имя пира и порт (для упрощения предполагается, что все пиры будут находиться в одной локальной сети 127.0.0.1, а их идентификаторами будут служить номера портов), после чего на данном порту запускается серверный сокет. Пир может подключаться к другим пирам по их номеру порта. Каждый пир хранит локальный лог сообщений, упорядоченных по времени создания. Сообщение характеризуется уникальным ID, временем создания, именем автора (пира) и текстовым содержимым. При подсоединении пира к сети из других пиров, отправленные сообщения начинают распространяться и на него тоже. Стоит отметить, что таким образом распространяются только сообщения, написанные после присоединения пира, то есть история чата ему не передается. Пир может быть отключен: в таком случае все внутренние соединения закрываются и ресурсы высвобождаются, а прежде связанные с ним пиры также удаляют соответствующие соединения.

### Технические детали
- С точки зрения потоков пир устроен следующим образом:
  - 1 поток на CLI для взаимодействия с пользователем
  - 1 поток на серверный сокет для прослушивания
  - по 1 потоку на каждый открытый сокет (серверный либо клиентский) для их прослушивания
- Между сокетами обмен информацией происходит с помощью JSON (используется библиотека jackson).
- Для локальных логов сообщений и списков соединений используется synchronized LinkedList.

## Формулировка
Написать приложение для peer-to-peer чата. Клиенты устанавливают связь друг с другом напрямую с помощью сокетов. Подключение третьего клиента к одному из двух других уже подключенных клиентов приводит к тому, что три клиента объединяются в единое информационное пространство, и сообщение от одного клиента видно всем остальным. Число подключающихся таким образом клиентов не ограничено. Предусмотреть в полном объёме сопутствующую обработку ошибок. Для сетевого взаимодействия использовать класс Socket (т.е. использование классов TcpClient, TcpListener и UdpClient запрещено). Реализовать графический интерфейс. Предусмотреть возможность выхода из программы и освобождение ресурсов.